/*
 * dfplayer.c
 *
 *  Created on: 2022. 2. 23.
 *      Author: sungt
 */


#include "dfplayer.h"
#include "uart.h"


static uint8_t rx_buf[DFPLAYER_COMMUNICATION_SIZE];
static uint8_t tx_buf[DFPLAYER_COMMUNICATION_SIZE];

/* dfplayer.c 내 에서만 사용하는 함수이므로 static으로 선언 */
static void 	dfplayer_SendControlMessage(uint8_t cmd, uint8_t para_msb, uint8_t para_lsb);
static uint16_t dfplayer_Checksum();

bool dfplayer_Init(void)
{


}


static void dfplayer_SendControlMessage(uint8_t ch, uint8_t cmd, uint8_t para_msb, uint8_t para_lsb)
{
	tx_buf[0] = START;
	tx_buf[1] = VER;
	tx_buf[2] = DATA_LENGTH;
	tx_buf[3] = cmd;
	tx_buf[4] = NO_FEED_BACK;
	tx_buf[5] = para_msb;
	tx_buf[6] = para_lsb;
	uint16_t checksum = dfplayer_Checksum();
	tx_buf[7] = (checksum & 0xFF00) >> 8;
	tx_buf[8] = checksum & 0xFF00;
	tx_buf[9] = END;

	for (int i = 0; i < 10; i++)
	{
	  uartPrintf(ch, tx_buf[i]);
	  delay_ms(200);
	}

}
